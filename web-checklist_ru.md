# Контрольный список для веб-тестирования на проникновение

## Фаза разведки

### Малый объем

* [ ] Определите веб-сервер, технологии и базу данных \([whatweb](https://github.com/urbanadventurer/WhatWeb), [webanalyze](https://github.com/rverton/webanalyze)\)
* [ ] Попробуйте найти /robots.txt /crossdomain.xml /clientaccesspolicy.xml /sitemap.xml and /.well-known/
* [ ] Просмотрите комментарии к исходному коду \(Burp Engagement Tools\)
* [ ] [Перечисление каталогов](../enumeration/web/crawl-fuzz.md)
* [ ] Поиск [ утекщие идентификаторы, emails](../recon/public-info-gathering.md) \([pwndb](https://github.com/davidtavarez/pwndb)\)
* [ ] Определить WAF \([whatwaf](https://github.com/Ekultek/WhatWaf), [wafw00f](https://github.com/EnableSecurity/wafw00f)\)
* [ ] [Гугл доркинг](../recon/public-info-gathering.md#google)
* [ ] [GitHub доркинг](../recon/public-info-gathering.md#github)/Github tools \([githound](https://github.com/tillson/git-hound), [git-search](https://github.com/gwen001/github-search)\)
* [ ] получение URL \([gau](https://github.com/lc/gau) , [waybackurls](https://github.com/tomnomnom/waybackurls), [hakrawler](https://github.com/hakluke/hakrawler)\)
* [ ] Проверить потенциально уязвимые URL \([gf-patterns](https://github.com/1ndianl33t/Gf-Patterns)\)
* [ ] Найти скрытые параметры \([paramspider](https://github.com/devanshbatham/ParamSpider)\)
* [ ] Автоматический поиск XSS \([dalfox](https://github.com/hahwul/dalfox)\)
* [ ] Проверить файлы резервных копий \([bfac](https://github.com/mazen160/bfac)\)
* [ ] Определить админку и панель входа
* [ ] Перехват битых ссылок \([blc](https://github.com/stevenvachon/broken-link-checker)\)
* [ ] Получить все файлы JS \([subjs](https://github.com/lc/subjs), [linkfinder](https://github.com/GerbenJavado/LinkFinder)\)
* [ ] JS жестко запрограммированные API и секреты \([secretfinder](https://github.com/m4ll0k/SecretFinder)\)
* [ ] JS анализ \([JSParser](https://github.com/nahamsec/JSParser), [JSFScan](https://github.com/KathanP19/JSFScan.sh), [JSScanner](https://github.com/dark-warlord14/JSScanner), [jshole](https://github.com/callforpapers-source/jshole)\)
* [ ] Запустить автоматический сканер \([nuclei](https://github.com/projectdiscovery/nuclei)\)
* [ ] Тестирование CORS \([CORScanner](https://github.com/chenjj/CORScanner), [corsy](https://github.com/s0md3v/Corsy)\)

### Medium scope

* [ ] [Перечислите субдомены ](../recon/subdomain-enum/) \([subfinder](https://github.com/projectdiscovery/subfinder), [assetfinder](https://github.com/tomnomnom/assetfinder), [amass](https://github.com/OWASP/Amass), [sudomy](https://github.com/Screetsec/Sudomy), [crobat](https://github.com/cgboal/sonarsearch), [SubDomainizer](https://github.com/nsonaniya2010/SubDomainizer)\)
* [ ] Перестановка поддоменов \([dnsgen](https://github.com/ProjectAnte/dnsgen)\)
* [ ] Поддомен bruteforce \([shuffledns](https://github.com/projectdiscovery/shuffledns), [subbrute](https://github.com/TheRook/subbrute)\)
* [ ] Определить живые поддомены \([httpx](https://github.com/projectdiscovery/httpx)\)
* [ ] [Поглощение субдоменов](../recon/subdomain-enum/subdomain-takeover.md) \([SubOver](https://github.com/Ice3man543/SubOver)\)
* [ ] Проверить наличие [облачных ресурсов](../enumeration/cloud/cloud-info-recon.md) \([cloudenum](https://github.com/initstring/cloud_enum), [cloudscrapper](https://github.com/jordanpotti/CloudScraper), [cloudlist](https://github.com/projectdiscovery/cloudlist)\)
* [ ] [Shodan](../recon/public-info-gathering.md#shodan)
* [ ] [Transfer zone](https://six2dez.gitbook.io/pentest-book/enumeration/ports#port-53-dns)
* [ ] Поддомены из поддоменов \([altdns](https://github.com/infosec-au/altdns), [flydns](https://github.com/shelld3v/flydns), [goaltdns](https://github.com/subfinder/goaltdns)\)
* [ ] Делайте скриншоты \([gowitness](https://github.com/sensepost/gowitness), [webscreenshot](https://github.com/maaaaz/webscreenshot), [aquatone](https://github.com/michenriksen/aquatone)\)

### Large scope

* [ ] Получить [ASN](../recon/public-info-gathering.md#amass) для диапазонов IP \([amass](https://github.com/OWASP/Amass), [asnlookup](https://github.com/yassineaboukir/Asnlookup), [metabigor](https://github.com/j3ssie/metabigor), [bgp](https://bgp.he.net/)\)
* [ ] Ознакомьтесь с последними [поступлениями (на счет)] (https://www.crunchbase.com/)

### Network

* [ ] Проверьте, разрешены ли пакеты ICMP
* [ ] Проверьте политики DMARC / SPF \([spoofcheck](https://github.com/BishopFox/spoofcheck)\)
* [ ] Открытые порты с [Shodan](https://www.shodan.io/)
* [ ] Сканирование всех портов
* [ ] Проверить порты UDP \([udp-proto-scanner](https://github.com/CiscoCXSecurity/udp-proto-scanner) or nmap\)
* [ ] Тестирование  [SSL ](../enumeration/ssl-tls.md)\([testssl](https://github.com/drwetter/testssl.sh)\)
* [ ] Если получили кредитки, попробуйте ввести пароль [распыления ](https://github.com/x90skysn3k/brutespray) для всех услуг обнаружили

### Подготовка

* [ ] Структура тестируемого сайта
* [ ] Составьте список со всеми возможными тестами
* [ ] Понимать сферу бизнеса и то, что нужно их клиентам
* [ ] Получите список всех ресурсов \(all\_subdomains.txt, live\_subdomains.txt, waybackurls.txt, hidden\_directories.txt, nmap\_results.txt, GitHub\_search.txt, altdns\_subdomain.txt, vulnerable\_links.txt, js\_files.txt\)

## Управление пользователями

### Регистрация

* [ ] Повторная регистрация (попробуйте использовать прописные буквы, +1 @ ..., точки в имени и т.Д.)
* [ ] Перезаписать существующего пользователя \(переход существующего пользователя\)
* [ ] Уникальность имени пользователя
* [ ] Политика слабых паролей \(пользователь = пароль, пароль = 123456,111111, abcabc, qwerty12\)
* [ ] Недостаточный процесс проверки электронной почты (../enumeration/web/email-attacks.md) \(также мой% 00email@mail.com для учетной записи tko\)
* [ ] Слабая реализация регистрации или позволяет использовать одноразовые адреса электронной почты
* [ ] Перебор после создания пользователя, чтобы проверить, была ли какая-либо папка перезаписана или создана с вашим именем профиля
* [ ] Добавляйте в пароль только пробелы
* [ ] Длинный пароль \(&gt;200\) ведет к DoS
* [ ] Поврежденная аутентификация и дефекты сеанса: зарегистрируйтесь, не проверяйте, запросите смену пароля, смените, проверьте, активна ли учетная запись.
* [ ] Попробуйте повторно зарегистрировать повторение одного и того же запроса с тем же паролем и другим паролем.
* [ ] Если запрос JSON, добавьте запятую {«электронная почта»: « жертва@mail.com », « hacker@mail.com », «токен»: «xxxxxxxxxx»}
* [ ] Отсутствие подтверждения -> попробуйте зарегистрироваться по электронной почте компании.
* [ ] Проверьте OAuth при регистрации в социальных сетях
* [ ] Проверить параметр состояния при регистрации в социальных сетях
* [ ] Попытайтесь получить URL-адрес интеграции, ведущий к поглощению интеграции
* [ ] Проверяйте перенаправления на странице регистрации после входа в систему
* [ ] Ограничение скорости при создании учетной записи
* [ ] XSS на имя или адрес электронной почты

### Аутентификация

* [ ] Перечисление имени пользователя
* [ ] Устойчивость к подбору пароля
* [ ] Функция восстановления аккаунта
* [ ] Функция "Запомнить меня"
* [ ] Функция олицетворения
* [ ] Небезопасное распространение учетных данных
* [ ] Условия открытия при отказе
* [ ] Многоступенчатые механизмы
* [ ] [SQL Injections](../enumeration/web/sqli.md)
* [ ] Автозаполнение тестирования
* [ ] Отсутствие подтверждения пароля при смене адреса электронной почты, пароля или двухфакторной аутентификации (попробуйте изменить ответ)
* [ ] Слабая функция входа в систему через HTTP и HTTPS, если оба доступны
* [ ] Механизм блокировки учетной записи пользователя при атаке методом перебора
* [ ] Проверьте список слов пароля \([cewl](https://github.com/digininja/CeWL) and [burp-goldenNuggets](https://github.com/GainSec/GoldenNuggets-1)\)
* [ ] Проверить функциональность входа 0auth для [Open Redirection](../enumeration/web/ssrf.md)
* [ ] Подделка тестового ответа при аутентификации [SAML ](../enumeration/webservices/onelogin-saml-login.md)authentication
* [ ] В OTP проверьте угадываемые коды и условия гонки
* [ ] OTP, проверьте манипуляции с ответом для обхода
* [ ] OTP, попробуйте брутфорс
* [ ] Если имеется [JWT](../enumeration/webservices/jwt.md), проверьте общие недостатки
* [ ] Слабость кеша браузера \(eg Pragma, Expires, Max-age\)
* [ ] После регистрации выйдите из системы, очистите кеш, перейдите на домашнюю страницу и вставьте URL своего профиля в браузер, проверьте наличие «login? Next = accounts / profile» для открытого перенаправления или XSS с помощью «/ login? Next = javascript: alert (1); // "
* [ ] Попробуйте войти в систему с общими, дефолтными [учетными данными](https://github.com/ihebski/DefaultCreds-cheat-sheet)

### Сессия

* [ ] Обработка сеанса
* [ ]  Тестовые жетоны на смысл
* [ ]  Тестовые жетоны на предсказуемость
* [ ]  Небезопасная передача токенов
* [ ]  Раскрытие токенов в логах
* [ ]  Сопоставление токенов сессиям
* [ ]  Завершение сеанса
* [ ]  Фиксация сеанса
* [ ] Подделка межсайтовых запросов [Cross-site request forgery](../enumeration/web/csrf.md)
* [ ] Объем файлов cookie
* [ ] Расшифровать куки (Base64, шестнадцатеричный, URL и т. Д.)
* [ ] Срок действия cookie
* [ ] Проверьте флаги HTTPOnly и Secure
* [ ] Использовать один и тот же файл cookie с другого действующего IP-адреса или системы
* [ ] Контроль доступа
* [ ] Эффективность контроля с использованием нескольких учетных записей
* [ ] Небезопасные методы контроля доступа (параметры запроса, заголовок Referer и т. Д.)
* [ ] Проверить одновременный вход через другой компьютер / IP
* [ ] Обходт токенов [AntiCSRF ](../enumeration/web/csrf.md#csrf-token-bypass)
* [ ] Слабые вопросы безопасности
* [ ] Обход файлов cookie
* [ ] Повторно использовать cookie после закрытия сеанса
* [ ] Выйдите из системы и нажмите в браузере функцию «вернуться назад» (Alt + стрелка влево)
* [ ] 2 экземпляра открыты, 1-й изменить или сбросить пароль, обновить 2-й экземпляр
* [ ] С привилегированным пользователем выполните привилегированные действия, попробуйте повторить с непривилегированным пользователем cookie.

### Профиль / данные учетной записи

* [ ] Find parameter with user id and try to tamper in order to get the details of other users
* [ ] Create a list of features that are pertaining to a user account only and try [CSRF](../enumeration/web/csrf.md)
* [ ] Change email id and update with any existing email id. Check if its getting validated on server or not.
* [ ] Check any new email confirmation link and what if user doesn't confirm.
* [ ] File [upload](../enumeration/web/upload-bypasses.md): [eicar](https://secure.eicar.org/eicar.com.txt), No Size Limit, File extension, Filter Bypass, [burp](https://github.com/portswigger/upload-scanner) extension, RCE
* [ ] CSV import/export: Command Injection, XSS, macro injection
* [ ] Check profile picture URL and find email id/user info or [EXIF Geolocation Data](http://exif.regex.info/exif.cgi)
* [ ] Imagetragick in picture profile upload
* [ ] [Metadata ](https://github.com/exiftool/exiftool)of all downloadable files \(Geolocation, usernames\)
* [ ] Account deletion option and try to reactivate with "Forgot password" feature
* [ ] Try bruteforce enumeration when change any user unique parameter.
* [ ] Check application request re-authentication for sensitive operations
* [ ] Try parameter pollution to add two values of same field
* [ ] Check different roles policy

### Забыли/сброшенный  пароль

* [ ] Invalidate session on Logout and Password reset
* [ ] Uniqueness of forget password reset link/code
* [ ] Reset links expiration time
* [ ] Find user id or other sensitive fields in reset link and tamper them
* [ ] Request 2 reset passwords links and use the older
* [ ] Check if many requests have sequential tokens
* [ ] Use username@burp\_collab.net and analyze the callback
* [ ] Host header injection for token leakage
* [ ] Add X-Forwarded-Host: evil.com to receive the reset link with evil.com
* [ ] Email crafting like victim@gmail.com@target.com
* [ ] IDOR in reset link
* [ ] Capture reset token and use with other email/userID
* [ ] No TLD in email parameter
* [ ] User carbon copy email=victim@mail.com%0a%0dcc:hacker@mail.com
* [ ] Long password \(&gt;200\) leads to DoS
* [ ] No rate limit, capture request and send over 1000 times
* [ ] Check encryption in reset password token
* [ ] Token leak in referer header
* [ ] Append second email param and value
* [ ] Understand how token is generated \(timestamp, username, birthdate,...\)
* [ ] Response manipulation

## Input handling

* [ ] Fuzz all request parameters \(if got user, add headers to fuzzer\)
* [ ] Identify all reflected data
* [ ] [Reflected XSS](../enumeration/web/xss.md)
* [ ] HTTP[ header injection](../enumeration/web/header-injections.md) in GET & POST \(X Forwarded Host\)
* [ ] RCE via Referer Header
* [ ] SQL injection via User-Agent Header
* [ ] Arbitrary redirection
* [ ] Stored attacks
* [ ] OS command injection
* [ ] Path [traversal](../enumeration/web/lfi-rfi.md), LFI and RFI
* [ ] Script injection
* [ ] File inclusion
* [ ] SMTP injection
* [ ] Native software flaws \(buffer overflow, integer bugs, format strings\)
* [ ] SOAP injection
* [ ] LDAP injection
* [ ] SSI Injection
* [ ] XPath injection
* [ ] [XXE](../enumeration/web/xxe.md) in any request, change content-type to text/xml
* [ ] Stored [XSS](../enumeration/web/xss.md)
* [ ] [SQL ](../enumeration/web/sqli.md)injection with ' and '--+-
* [ ] [NoSQL ](../enumeration/webservices/nosql-and-and-mongodb.md)injection
* [ ] HTTP Request [Smuggling](../enumeration/web/request-smuggling.md)
* [ ] [Open redirect](../enumeration/web/ssrf.md)
* [ ] Code Injection \(&lt;h1&gt;six2dez&lt;/h1&gt; on stored param\)
* [ ] [SSRF ](../enumeration/web/ssrf.md)in previously discovered open ports
* [ ] xmlrpc.php DOS and user enumeration
* [ ] HTTP dangerous methods OPTIONS PUT DELETE
* [ ] Try to discover hidden parameters \([arjun ](https://github.com/s0md3v/Arjun)or [parameth](https://github.com/maK-/parameth)\)

### Error handling

* [ ] Access custom pages like /whatever\_fake.php \(.aspx,.html,.etc\)
* [ ] Add multiple parameters in GET and POST request using different values
* [ ] Add "\[\]", "\]\]", and "\[\[" in cookie values and parameter values to create errors
* [ ] Generate error by giving input as "/~randomthing/%s" at the end of URL
* [ ] Use Burp Intruder "Fuzzing Full" List in input to generate error codes
* [ ] Try different HTTP Verbs like PATCH, DEBUG or wrong like FAKE

## Application Logic

* [ ] Identify the logic attack surface
* [ ] Test transmission of data via the client
* [ ] Test for reliance on client-side input validation
* [ ] Thick-client components \(Java, ActiveX, Flash\)
* [ ] Multi-stage processes for logic flaws
* [ ] Handling of incomplete input
* [ ] Trust boundaries
* [ ] Transaction logic
* [ ] Implemented CAPTCHA in email forms to avoid flooding
* [ ] Tamper product id, price or quantity value in any action \(add, modify, delete, place, pay...\)
* [ ] Tamper gift or discount codes
* [ ] Reuse gift codes
* [ ] Try parameter pollution to use gift code two times in same request
* [ ] Try stored XSS in non-limited fields like address
* [ ] Check in payment form if CVV and card number is in clear text or masked
* [ ] Check if is processed by the app itself or sent to 3rd parts
* [ ] IDOR from other users details ticket/cart/shipment
* [ ] Check for test credit card number allowed like 4111 1111 1111 1111 \([sample1](https://www.paypalobjects.com/en_GB/vhelp/paypalmanager_help/credit_card_numbers.htm) [sample2](http://support.worldpay.com/support/kb/bg/testandgolive/tgl5103.html)\)
* [ ] Check PRINT or PDF creation for IDOR
* [ ] Check unsubscribe button with user enumeration
* [ ] Parameter pollution on social media sharing links
* [ ] Change POST sensitive requests to GET

## Other checks

### Infrastructure

* [ ] Segregation in shared infrastructures
* [ ] Segregation between ASP-hosted applications
* [ ] Web server vulnerabilities
* [ ] Dangerous HTTP methods
* [ ] Proxy functionality
* [ ] [Virtual ](../enumeration/webservices/vhosts.md)hosting misconfiguration \([VHostScan](https://github.com/codingo/VHostScan)\)
* [ ] Check for internal numeric IP's in request
* [ ] Check for external numeric IP's and resolve it
* [ ] Test [cloud ](../enumeration/cloud/cloud-info-recon.md)storage
* [ ] Check the existence of alternative channels \(www.web.com vs m.web.com\)

### CAPTCHA

* [ ] Send old captcha value. 
* [ ] Send old captcha value with old session ID.
* [ ] Request captcha absolute path like www.url.com/captcha/1.png
* [ ] Remove captcha with any adblocker and request again
* [ ] Bypass with OCR tool \([easy one](https://github.com/pry0cc/prys-hacks/blob/master/image-to-text)\)
* [ ] Change from POST to GET
* [ ] Remove captcha parameter
* [ ] Convert JSON request to normal
* [ ] Try header injections

### Security Headers

* [ ] X-XSS-Protection
* [ ] Strict-Transport-Security
* [ ] Content-Security-Policy
* [ ] Public-Key-Pins
* [ ] X-Frame-Options
* [ ] X-Content-Type-Options
* [ ] Referer-Policy
* [ ] Cache-Control
* [ ] Expires



