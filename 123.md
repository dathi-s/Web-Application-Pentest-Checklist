# Контрольный список для веб-тестирования на проникновение

https://github.com/six2dez/pentest-book/blob/master/others/web-checklist.md Спасибо six2dez

## Фаза разведки

### Малый объем

* Определите веб-сервер, технологии и базу данных \([whatweb](https://github.com/urbanadventurer/WhatWeb), [webanalyze](https://github.com/rverton/webanalyze)\)
*Попробуйте найти /robots.txt /crossdomain.xml /clientaccesspolicy.xml /sitemap.xml and /.well-known/
*Просмотрите комментарии к исходному коду \(Burp Engagement Tools\)
*[Перечисление каталогов](../enumeration/web/crawl-fuzz.md)
*Поиск [ утекщие идентификаторы, emails](../recon/public-info-gathering.md) \([pwndb](https://github.com/davidtavarez/pwndb)\)
*Определить WAF \([whatwaf](https://github.com/Ekultek/WhatWaf), [wafw00f](https://github.com/EnableSecurity/wafw00f)\)
*[Гугл доркинг](../recon/public-info-gathering.md#google)
*[GitHub доркинг](../recon/public-info-gathering.md#github)/Github tools \([githound](https://github.com/tillson/git-hound), [git-search](https://github.com/gwen001/github-search)\)
*получение URL \([gau](https://github.com/lc/gau) , [waybackurls](https://github.com/tomnomnom/waybackurls), [hakrawler](https://github.com/hakluke/hakrawler)\)
*Проверить потенциально уязвимые URL \([gf-patterns](https://github.com/1ndianl33t/Gf-Patterns)\)
*Найти скрытые параметры \([paramspider](https://github.com/devanshbatham/ParamSpider)\)
*Автоматический поиск XSS \([dalfox](https://github.com/hahwul/dalfox)\)
*Проверить файлы резервных копий \([bfac](https://github.com/mazen160/bfac)\)
*Определить админку и панель входа
*Перехват битых ссылок \([blc](https://github.com/stevenvachon/broken-link-checker)\)
*Получить все файлы JS \([subjs](https://github.com/lc/subjs), [linkfinder](https://github.com/GerbenJavado/LinkFinder)\)
*JS жестко запрограммированные API и секреты \([secretfinder](https://github.com/m4ll0k/SecretFinder)\)
*JS анализ \([JSParser](https://github.com/nahamsec/JSParser), [JSFScan](https://github.com/KathanP19/JSFScan.sh), [JSScanner](https://github.com/dark-warlord14/JSScanner), [jshole](https://github.com/callforpapers-source/jshole)\)
*Запустить автоматический сканер \([nuclei](https://github.com/projectdiscovery/nuclei)\)
*Тестирование CORS \([CORScanner](https://github.com/chenjj/CORScanner), [corsy](https://github.com/s0md3v/Corsy)\)

### Medium scope

*[Перечислите субдомены ](../recon/subdomain-enum/) \([subfinder](https://github.com/projectdiscovery/subfinder), [assetfinder](https://github.com/tomnomnom/assetfinder), [amass](https://github.com/OWASP/Amass), [sudomy](https://github.com/Screetsec/Sudomy), [crobat](https://github.com/cgboal/sonarsearch), [SubDomainizer](https://github.com/nsonaniya2010/SubDomainizer)\)
*Перестановка поддоменов \([dnsgen](https://github.com/ProjectAnte/dnsgen)\)
*Поддомен bruteforce \([shuffledns](https://github.com/projectdiscovery/shuffledns), [subbrute](https://github.com/TheRook/subbrute)\)
*Определить живые поддомены \([httpx](https://github.com/projectdiscovery/httpx)\)
*[Поглощение субдоменов](../recon/subdomain-enum/subdomain-takeover.md) \([SubOver](https://github.com/Ice3man543/SubOver)\)
*Проверить наличие [облачных ресурсов](../enumeration/cloud/cloud-info-recon.md) \([cloudenum](https://github.com/initstring/cloud_enum), [cloudscrapper](https://github.com/jordanpotti/CloudScraper), [cloudlist](https://github.com/projectdiscovery/cloudlist)\)
*[Shodan](../recon/public-info-gathering.md#shodan)
*[Transfer zone](https://six2dez.gitbook.io/pentest-book/enumeration/ports#port-53-dns)
*Поддомены из поддоменов \([altdns](https://github.com/infosec-au/altdns), [flydns](https://github.com/shelld3v/flydns), [goaltdns](https://github.com/subfinder/goaltdns)\)
*Делайте скриншоты \([gowitness](https://github.com/sensepost/gowitness), [webscreenshot](https://github.com/maaaaz/webscreenshot), [aquatone](https://github.com/michenriksen/aquatone)\)

### Large scope

*Получить [ASN](../recon/public-info-gathering.md#amass) для диапазонов IP \([amass](https://github.com/OWASP/Amass), [asnlookup](https://github.com/yassineaboukir/Asnlookup), [metabigor](https://github.com/j3ssie/metabigor), [bgp](https://bgp.he.net/)\)
*Ознакомьтесь с последними [поступлениями (на счет)] (https://www.crunchbase.com/)

### Network

*Проверьте, разрешены ли пакеты ICMP
*Проверьте политики DMARC / SPF \([spoofcheck](https://github.com/BishopFox/spoofcheck)\)
*Открытые порты с [Shodan](https://www.shodan.io/)
*Сканирование всех портов
*Проверить порты UDP \([udp-proto-scanner](https://github.com/CiscoCXSecurity/udp-proto-scanner) or nmap\)
*Тестирование  [SSL ](../enumeration/ssl-tls.md)\([testssl](https://github.com/drwetter/testssl.sh)\)
*Если получили кредитки, попробуйте ввести пароль [распыления ](https://github.com/x90skysn3k/brutespray) для всех услуг обнаружили

### Подготовка

*Структура тестируемого сайта
*Составьте список со всеми возможными тестами
*Понимать сферу бизнеса и то, что нужно их клиентам
*Получите список всех ресурсов \(all\_subdomains.txt, live\_subdomains.txt, waybackurls.txt, hidden\_directories.txt, nmap\_results.txt, GitHub\_search.txt, altdns\_subdomain.txt, vulnerable\_links.txt, js\_files.txt\)

## Управление пользователями

### Регистрация

*Повторная регистрация (попробуйте использовать прописные буквы, +1 @ ..., точки в имени и т.Д.)
*Перезаписать существующего пользователя \(переход существующего пользователя\)
*Уникальность имени пользователя
*Политика слабых паролей \(пользователь = пароль, пароль = 123456,111111, abcabc, qwerty12\)
*Недостаточный процесс проверки электронной почты (../enumeration/web/email-attacks.md) \(также мой% 00email@mail.com для учетной записи tko\)
*Слабая реализация регистрации или позволяет использовать одноразовые адреса электронной почты
*Перебор после создания пользователя, чтобы проверить, была ли какая-либо папка перезаписана или создана с вашим именем профиля
*Добавляйте в пароль только пробелы
*Длинный пароль \(&gt;200\) ведет к DoS
*Поврежденная аутентификация и дефекты сеанса: зарегистрируйтесь, не проверяйте, запросите смену пароля, смените, проверьте, активна ли учетная запись.
*Попробуйте повторно зарегистрировать повторение одного и того же запроса с тем же паролем и другим паролем.
*Если запрос JSON, добавьте запятую {«электронная почта»: « жертва@mail.com », « hacker@mail.com », «токен»: «xxxxxxxxxx»}
*Отсутствие подтверждения -> попробуйте зарегистрироваться по электронной почте компании.
*Проверьте OAuth при регистрации в социальных сетях
*Проверить параметр состояния при регистрации в социальных сетях
*Попытайтесь получить URL-адрес интеграции, ведущий к поглощению интеграции
*Проверяйте перенаправления на странице регистрации после входа в систему
*Ограничение скорости при создании учетной записи
*XSS на имя или адрес электронной почты

### Аутентификация

*Перечисление имени пользователя
*Устойчивость к подбору пароля
*Функция восстановления аккаунта
*Функция "Запомнить меня"
*Функция олицетворения
*Небезопасное распространение учетных данных
*Условия открытия при отказе
*Многоступенчатые механизмы
*[SQL Injections](../enumeration/web/sqli.md)
*Автозаполнение тестирования
*Отсутствие подтверждения пароля при смене адреса электронной почты, пароля или двухфакторной аутентификации (попробуйте изменить ответ)
*Слабая функция входа в систему через HTTP и HTTPS, если оба доступны
*Механизм блокировки учетной записи пользователя при атаке методом перебора
*Проверьте список слов пароля \([cewl](https://github.com/digininja/CeWL) and [burp-goldenNuggets](https://github.com/GainSec/GoldenNuggets-1)\)
*Проверить функциональность входа 0auth для [Open Redirection](../enumeration/web/ssrf.md)
*Подделка тестового ответа при аутентификации [SAML ](../enumeration/webservices/onelogin-saml-login.md)authentication
*В OTP проверьте угадываемые коды и условия гонки
*OTP, проверьте манипуляции с ответом для обхода
*OTP, попробуйте брутфорс
*Если имеется [JWT](../enumeration/webservices/jwt.md), проверьте общие недостатки
*Слабость кеша браузера \(eg Pragma, Expires, Max-age\)
*После регистрации выйдите из системы, очистите кеш, перейдите на домашнюю страницу и вставьте URL своего профиля в браузер, проверьте наличие «login? Next = accounts / profile» для открытого перенаправления или XSS с помощью «/ login? Next = javascript: alert (1); // "
*Попробуйте войти в систему с общими, дефолтными [учетными данными](https://github.com/ihebski/DefaultCreds-cheat-sheet)

### Сессия

*Обработка сеанса
* Тестовые жетоны на смысл
* Тестовые жетоны на предсказуемость
* Небезопасная передача токенов
* Раскрытие токенов в логах
* Сопоставление токенов сессиям
* Завершение сеанса
* Фиксация сеанса
*Подделка межсайтовых запросов [Cross-site request forgery](../enumeration/web/csrf.md)
*Объем файлов cookie
*Расшифровать куки (Base64, шестнадцатеричный, URL и т. Д.)
*Срок действия cookie
*Проверьте флаги HTTPOnly и Secure
*Использовать один и тот же файл cookie с другого действующего IP-адреса или системы
*Контроль доступа
*Эффективность контроля с использованием нескольких учетных записей
*Небезопасные методы контроля доступа (параметры запроса, заголовок Referer и т. Д.)
*Проверить одновременный вход через другой компьютер / IP
*Обходт токенов [AntiCSRF ](../enumeration/web/csrf.md#csrf-token-bypass)
*Слабые вопросы безопасности
*Обход файлов cookie
*Повторно использовать cookie после закрытия сеанса
*Выйдите из системы и нажмите в браузере функцию «вернуться назад» (Alt + стрелка влево)
*2 экземпляра открыты, 1-й изменить или сбросить пароль, обновить 2-й экземпляр
*С привилегированным пользователем выполните привилегированные действия, попробуйте повторить с непривилегированным пользователем cookie.

### Профиль / данные учетной записи

*Найдите параметр с идентификатором пользователя и попробуйте вмешаться, чтобы получить информацию о других пользователях
*Создайте список функций, которые относятся только к учетной записи пользователя, и попробуйте [CSRF](../enumeration/web/csrf.md)
*Измените идентификатор электронной почты и обновите с помощью любого существующего идентификатора электронной почты. Проверьте, проверяется ли он на сервере или нет.
*Проверьте любую новую ссылку для подтверждения по электронной почте и что делать, если пользователь не подтверждает.
*Загрузка [файла](../enumeration/web/upload-bypasses.md): [eicar](https://secure.eicar.org/eicar.com.txt), без ограничения размера, расширение файла, обход фильтра, [burp](https://github.com/portswigger/upload-scanner) расширение, RCE
*Импорт / экспорт CSV: внедрение команд, XSS, внедрение макросов
*Проверьте URL-адрес изображения профиля и найдите идентификатор электронной почты / информацию о пользователе или [данные геолокации EXIF](http://exif.regex.info/exif.cgi)
*Imagetragick в загрузке профиля изображения
*[Metadata ](https://github.com/exiftool/exiftool) всех загружаемых файлов\(геолокация, имена пользователей\)
*Возможность удаления учетной записи и попытка повторной активации с помощью функции «Забыли пароль»
*Попробуйте перебор перебором при изменении любого уникального параметра пользователя.
*Проверьте повторную аутентификацию запроса приложения на наличие конфиденциальных операций
*Попробуйте загрязнение параметров, чтобы добавить два значения одного и того же поля
*Проверьте политику разных ролей

### Забыли/сброшенный  пароль

*Недействительный сеанс при выходе из системы и сбросе пароля
*Уникальность ссылки/кода для сброса пароля
*Сбросить срок действия ссылок
*Найдите идентификатор пользователя или другие конфиденциальные поля в ссылке для сброса и измените их
*Запросите 2 ссылки для сброса паролей и используйте старую
*Проверить, есть ли у многих запросов последовательные токены
*Используйте имя пользователя @ burp \ _collab.net и проанализируйте обратный вызов
*Внедрение заголовка хоста для утечки токена
*Добавьте X-Forwarded-Host: evil.com, чтобы получить ссылку сброса с evil.com
*Обработка писем, например, жертва @ gmail.com @ target.com
*IDOR в ссылке для сброса
*Захватить токен сброса и использовать с другим адресом электронной почты / идентификатором пользователя
*Нет TLD в параметре электронной почты
*Копия пользователя email=victim@mail.com%0a%0dcc: hacker@mail.com
*Длинный пароль \(& gt; 200 \) ведет к DoS
*Нет ограничения скорости, запрос захвата и отправка более 1000 раз
*Проверить шифрование в токене сброса пароля
*Утечка токена в заголовке реферера
*Добавить второй параметр и значение электронной почты
*Узнайте, как создается токен \(отметка времени, имя пользователя, дата рождения, ... \)
*Манипуляции с ответами

## Обработка ввода

*Фаззинг всех параметров запроса \(если есть пользователь, добавить заголовок в фаззер \)
*Определить все отражаемые данные
*[Отраженный XSS](../enumeration/web/xss.md)
*HTTP[ внедрение заголовка](../enumeration/web/header-injections.md) in GET & POST \(X Forwarded Host\)
*RCE через заголовок Referer
*SQL-инъекция через заголовок User-Agent
*Произвольное перенаправление
*Сохраненные атаки
*Внедрение команды ОС \(OS command injection\)
*Обход [пути](../enumeration/web/lfi-rfi.md), LFI and RFI
*Внедрение скрипта Script injection
*Включение файла File inclusion
*SMTP-инъекция
*Недостатки собственного программного обеспечения \(переполнение буфера, целочисленные ошибки, строки формата \)
*Внедрение SOAP
*Внедрение LDAP
*Внедрение SSI
*Внедрение XPath
*[XXE](../enumeration/web/xxe.md) в любом запросе измените тип содержимого на text/xml
*Сохраненная [XSS](../enumeration/web/xss.md)
*[SQL ](../enumeration/web/sqli.md) инъекция with ' and '--+-
*[NoSQL ](../enumeration/webservices/nosql-and-and-mongodb.md) инъекция
*HTTP Request [Smuggling](../enumeration/web/request-smuggling.md)
*[Открытое перенаправление](../enumeration/web/ssrf.md)
*Внедрение кода \(&lt;h1&gt;six2dez&lt;/h1&gt; в сохраненных параметрах\)
*[SSRF ](../enumeration/web/ssrf.md) в ранее обнаруженных открытых портах
*xmlrpc.php DOS и перечисление пользователей
*Опасные методы HTTP OPTIONS PUT DELETE
*Попробуйте обнаружить скрытые параметры \([arjun ](https://github.com/s0md3v/Arjun) или [параметры](https://github.com/maK-/parameth)\)

### Обработка ошибок

*Доступ к пользовательским страницам, например /whatever\_fake.php \(. Aspx, .html, .etc \)
*Добавить несколько параметров в запросы GET и POST, используя разные значения
*Добавьте «\[\]», «\]\]» и «\[\[» в значения файлов cookie и значений параметров для создания ошибок
*Сгенерировать ошибку, введя "/~randomthing/%s" в конце URL-адреса.
*Используйте "Fuzzing Full" список Burp Intruder во входных данных для генерации кодов ошибок
*Попробуйте разные HTTP-глаголы, такие как PATCH, DEBUG или неверные, например FAKE.

## Логика приложения

*Определите поверхность логической атаки
*Тестовая передача данных через клиента
*Тест на надежность проверки ввода на стороне клиента
*Компоненты толстого клиента \(Java, ActiveX, Flash \)
*Многоступенчатые процессы устранения логических ошибок
*Обработка неполного ввода
*Границы доверия
*Логика транзакции
*Реализована CAPTCHA в формах электронной почты, чтобы избежать флуда
*Вмешательство идентификатора продукта, цены или количества в любом действии \(добавление, изменение, удаление, размещение, оплата ... \)
*Тампер подарочные коды или коды скидок
*Повторно использовать подарочные коды
*Попробуйте изменить параметр, чтобы использовать подарочный код два раза в одном запросе
*Попробуйте сохранить XSS в неограниченных полях, таких как адрес
*Проверьте в форме оплаты, указаны ли CVV и номер карты открытым текстом или замаскированы.
*Проверить, обрабатывается ли оно самим приложением или отправляется третьим частям
*IDOR от других пользователей подробности билета / тележки / отгрузки
*Проверка разрешенного номера тестовой кредитной карты, например 4111 1111 1111 1111 \([sample1](https://www.paypalobjects.com/en_GB/vhelp/paypalmanager_help/credit_card_numbers.htm) [sample2](http://support.worldpay.com/support/kb/bg/testandgolive/tgl5103.html)\)
*Проверьте создание PRINT или PDF для IDOR
*Отметьте кнопку отказа от подписки с перечислением пользователей
*Загрязнение параметров ссылок для публикации в социальных сетях
*Изменить чувствительные к POST запросы на GET

## Other checks

### Infrastructure

*Разделение в общих инфраструктурах
*Разделение между приложениями, размещенными на ASP
*Уязвимости веб-сервера
*Опасные методы HTTP
*Функциональность прокси
*[Неправильная ](../enumeration/webservices/vhosts.md) конфигурация виртуального хостинга \([VHostScan](https://github.com/codingo/VHostScan)\)
*Проверить внутренние числовые IP-адреса в запросе
*Проверить внешние числовые IP-адреса и разрешить их
*Тестировать [облачное ](../enumeration/cloud/cloud-info-recon.md) хранилище
*Проверить наличие альтернативных каналов \(www.web.com vs m.web.com\)

### CAPTCHA

*Отправить старое значение капчи.
*Отправить старое значение капчи со старым идентификатором сеанса.
*Запросить абсолютный путь капчи, например www.url.com/captcha/1.png
*Удалить капчу любым блокировщиком рекламы и запросить еще раз
*Обход с помощью инструмента OCR \([простой] (https://github.com/pry0cc/prys-hacks/blob/master/image-to-text)\)
*Изменить с POST на GET
*Удалить параметр captcha
*Преобразовать запрос JSON в нормальный
*Попробуйте инъекции заголовков

### Заголовки безопасности

*X-XSS-Protection
*Strict-Transport-Security
*Content-Security-Policy
*Public-Key-Pins
*X-Frame-Options
*X-Content-Type-Options
*Referer-Policy
*Cache-Control
*Expires



